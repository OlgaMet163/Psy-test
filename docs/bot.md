# Документация Telegram-бота

## Цели бота
- Собрать ответы по тестам (HEXACO, SVS, Hogan DSUSI-SF) и выдать интерпретации пользователю.
- Предоставить админу расширенные отчёты, прогресс пользователей и выгрузки в Google Sheets.
- Управлять согласием на мэтчинг, хранить профили и выдавать рекомендации.

## Основные сценарии диалога
1. Приветствие + предложение пройти три тестирования подряд.
2. Выбор теста/продолжение незавершённого прохождения.
3. Ответ на утверждение через инлайн-кнопки (значения -2…+2).
4. Получение результатов/комментариев + предложение перейти к следующему тесту.
5. Включение/выключение участия в мэтчинге.

## Состояния пользователя
- `idle`: пользователь только начал, тест не выбран.
- `hexaco_in_progress`: указываем текущий номер вопроса и накопленные ответы.
- `hexaco_completed`: сохранены проценты и выданы интерпретации (доступен переход к SVS).
- Аналогичные состояния для SVS и Under Stress.
- `matching_enabled`: пользователь согласился участвовать в мэтчинге.

## Интеграции
- Telegram Bot API (webhook).
- Backend API для расчётов и записи данных.
- Локальное хранилище SQLite (`data/bot.db`) для ответов и результатов; выгрузка CSV по команде `python scripts/export_hexaco.py`.

## Админские функции
- Просмотр списка пользователей, фильтр по статусу тестов.
- Просмотр сырых ответов и расширенных шкал (включая тёмную триаду).
- Воркфлоу с Google Sheets: вручную инициировать повторную выгрузку или скачать CSV.
- Управление текстами интерпретаций и приветственных сообщений.

## UX-заметки
- Кнопки ответов всегда в одном порядке (от «Точно не про меня» до «Точно про меня»), чтобы пользователь быстро запоминал шкалу.
- При смене теста бот сообщает, сколько времени займёт следующий блок и что прогресс можно сохранить.
- Если бот «думает» после ответа, показываем сообщение «Обрабатываю результат…».

